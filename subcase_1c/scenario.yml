---
version: "1.0"
name: "subcase_1c"
description: "Scenario for subcase 1c"
metadata:
  author: "TechAnalysisSecManage"
  category: "training"
  difficulty: "medium"
  created: "2024-01-01"
network:
  name: "malnet"
  subnet: "10.20.0.0/24"
  gateway: "10.20.0.1"
playbook: "ansible/playbook.yml"
nodes:
  infected-host:
    image: "kali"
    role: "victim"
    ip: "10.20.0.10"
    subnet: "10.20.0.0/24"
    gateway: "10.20.0.1"
    startup_scripts:
      - path: "scripts/load_malware_simulation.ps1"
        args: "-ExecutionPolicy Bypass"
  c2-server:
    image: "ubuntu-noble-x86_64"
    role: "c2"
    ip: "10.20.0.11"
    subnet: "10.20.0.0/24"
    gateway: "10.20.0.1"
    startup_scripts:
      - path: "scripts/start_c2_server.sh"
        args: "--config /etc/c2.conf"
  soc-server:
    image: "ubuntu-noble-x86_64"
    role: "soc"
    services:
      - "NG-SOAR"
      - "NG-SIEM"
      - "BIPS"
      - "CICMS"
    ip: "10.20.0.12"
    subnet: "10.20.0.0/24"
    gateway: "10.20.0.1"
    startup_scripts:
      - path: "scripts/start_soc_services.sh"
      - path: "scripts/bips_start.sh"
  cti-component:
    image: "ubuntu-noble-x86_64"
    role: "cti"
    services:
      - "MISP"
      - "NG-SIEM"
    ip: "10.20.0.13"
    subnet: "10.20.0.0/24"
    gateway: "10.20.0.1"
    startup_scripts:
      - path: "scripts/start_cti_component.sh"
        args: "--sync"
links:
  - [infected-host, c2-server]
  - [infected-host, soc-server]
  - [soc-server, cti-component]
alerts:
  - source: malware_detection
    notify: email
    description: "Notify SOC when malware is detected"
  - source: bips
    notify: syslog
    description: "Notify SOC on intrusion detection"
