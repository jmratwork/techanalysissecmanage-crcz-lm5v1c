---
kypo_sandbox_definition_version: 3
name: "Agenda Sandbox"
description: >-
  Sandbox for agenda-driven activities using the Subcase 1c malware analysis and
  cyber threat intelligence environment.
topology:
  name: "sandbox-agenda-topology"
  hosts:
    - name: "infected-host"
      base_box:
        image: "kali"
        mgmt_user: "debian"
      flavor: "standard.medium"
    - name: "c2-server"
      base_box:
        image: "ubuntu-noble-x86_64"
        mgmt_user: "ubuntu"
      flavor: "standard.medium"
    - name: "soc-server"
      base_box:
        image: "ubuntu-noble-x86_64"
        mgmt_user: "ubuntu"
      flavor: "standard.medium"
    - name: "cti-component"
      base_box:
        image: "ubuntu-noble-x86_64"
        mgmt_user: "ubuntu"
      flavor: "standard.medium"
  routers:
    - name: "gateway-router"
      base_box:
        image: "ubuntu-noble-x86_64"
        mgmt_user: "ubuntu"
      flavor: "standard.medium"
  wan:
    name: "wan"
    cidr: "100.100.100.0/24"
  networks:
    - name: "malnet"
      cidr: "10.20.0.0/24"
  router_mappings:
    - router: "gateway-router"
      network: "malnet"
      ip: "10.20.0.1"
  net_mappings:
    - host: "infected-host"
      network: "malnet"
      ip: "10.20.0.2"
    - host: "c2-server"
      network: "malnet"
      ip: "10.20.0.3"
    - host: "soc-server"
      network: "malnet"
      ip: "10.20.0.4"
    - host: "cti-component"
      network: "malnet"
      ip: "10.20.0.5"
  groups: []
provisioning:
  playbook: site.yml
