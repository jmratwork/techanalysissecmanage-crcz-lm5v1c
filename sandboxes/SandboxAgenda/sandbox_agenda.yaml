---
kypo_sandbox_definition_version: 3
name: "Sandbox Agenda"
description: >-
  Definition file pairing the agenda-specific sandbox with its topology and
  provisioning playbook.
backend:
  type: terraform
  flavors:
    small:
      vcpus: 1
      ram_mb: 2048
      disk_gb: 20
    medium:
      vcpus: 2
      ram_mb: 4096
      disk_gb: 40
topology:
  name: "sandbox-agenda-topology"
  hosts:
    - name: "infected-host"
      base_box:
        image: "kali"
        mgmt_user: "kali"
      flavor: "medium"
    - name: "c2-server"
      base_box:
        image: "debian-11"
        mgmt_user: "debian"
      flavor: "medium"
    - name: "soc-server"
      base_box:
        image: "debian-11"
        mgmt_user: "debian"
      flavor: "medium"
    - name: "cti-component"
      base_box:
        image: "debian-11"
        mgmt_user: "debian"
      flavor: "medium"
  routers:
    - name: "gateway-router"
      base_box:
        image: "vyos"
        mgmt_user: "vyos"
      flavor: "medium"
  wan:
    name: "wan"
    cidr: "100.100.100.0/24"
  networks:
    - name: "malnet"
      cidr: "10.20.0.0/24"
  router_mappings:
    - router: "gateway-router"
      network: "malnet"
      ip: "10.20.0.1"
  net_mappings:
    - host: "infected-host"
      network: "malnet"
      ip: "10.20.0.2"
    - host: "c2-server"
      network: "malnet"
      ip: "10.20.0.3"
    - host: "soc-server"
      network: "malnet"
      ip: "10.20.0.4"
    - host: "cti-component"
      network: "malnet"
      ip: "10.20.0.5"
  groups: []
provisioning:
  playbook: site.yml
