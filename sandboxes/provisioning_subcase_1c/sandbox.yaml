---
kypo_sandbox_definition_version: 3
name: "Subcase 1c Sandbox"
description: >-
  Sandbox definition for the Subcase 1c malware analysis and cyber threat
  intelligence lab environment.
backend:
  type: terraform
  flavors:
    # Backend currently exposes only the "small" flavor; all nodes target it
    # to avoid flavor resolution errors when importing to KYPO/terraform.
    small:
      vcpus: 1
      ram_mb: 2048
      disk_gb: 20
topology:
  name: "subcase-1c-topology"
  hosts:
    - name: "infected-host"
      base_box:
        image: "kali"
        mgmt_user: "kali"
      flavor: "small"
    - name: "c2-server"
      base_box:
        image: "debian-11"
        mgmt_user: "debian"
      flavor: "small"
    - name: "soc-server"
      base_box:
        image: "debian-11"
        mgmt_user: "debian"
      flavor: "small"
    - name: "cti-component"
      base_box:
        image: "debian-11"
        mgmt_user: "debian"
      flavor: "small"
  routers:
    - name: "gateway-router"
      base_box:
        image: "vyos"
        mgmt_user: "vyos"
      flavor: "small"
  wan:
    name: "wan"
    cidr: "100.100.100.0/24"
  networks:
    - name: "malnet"
      cidr: "10.20.0.0/24"
  router_mappings:
    - router: "gateway-router"
      network: "malnet"
      ip: "10.20.0.1"
  net_mappings:
    - host: "infected-host"
      network: "malnet"
      ip: "10.20.0.2"
    - host: "c2-server"
      network: "malnet"
      ip: "10.20.0.3"
    - host: "soc-server"
      network: "malnet"
      ip: "10.20.0.4"
    - host: "cti-component"
      network: "malnet"
      ip: "10.20.0.5"
  groups: []
provisioning:
  playbook: site.yml
